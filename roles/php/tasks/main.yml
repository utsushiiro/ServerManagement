---
- name: Import Remi Repository
  yum:
    name: "{{ php_repository_url }}"
    state: present

- name: Install PHP
  yum:
    name: "{{ item }}"
    enablerepo: "{{ php_repository_name }}"
    state: present
  with_items: "{{ php_packages }}"

- name: Set date.timezone
  ini_file:
    dest: /etc/php.ini
    section: Date
    option: date.timezone
    value: Asia/Tokyo

- name: Set error_log
  ini_file:
    dest: /etc/php.ini
    section: PHP
    option: error_log
    value: /var/log/php_errors.log

- name: Set mbstring.language
  ini_file:
    dest: /etc/php.ini
    section: mbstring
    option: mbstring.language
    value: Japanese

- name: Restart httpd
  systemd:
    name: httpd
    state: restarted
    daemon_reload: yes
    enabled: yes

- name: Deploy a sample page for PHP
  shell: "echo '<?php phpinfo() ?>' > /var/www/html/info.php"
  args:
    creates: /var/www/html/info.php
